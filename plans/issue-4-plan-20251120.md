# Plan to Resolve Issue #4: Implement feed file data ingest

**Date:** 2025-11-20

This plan outlines the steps to implement the `ingest` subcommand for `prompthound` as described in GitHub issue #4.

## Task Checklist

- [ ] **1. Create `ingest` subcommand:**
    - [ ] Add an `ingest` subcommand to `src/prompthound/cli.py`.
    - [ ] The subcommand should accept a list of filenames as arguments.
    - [ ] The subcommand should be able to read from `stdin` if no filenames are provided.
    - [ ] Add a `--db` option to specify the database path.

- [ ] **2. Implement Database Handling:**
    - [ ] Use a default database path of `prompthound.db` in the appropriate user data directory.
    - [ ] If the database file specified by `--db` exists, prompt the user for confirmation before overwriting.
    - [ ] Initialize the `feed-to-sqlite` database schema if the database is new or overwritten.

- [ ] **3. Implement Ingestion Logic:**
    - [ ] Read and parse feed data from files or `stdin`.
    - [ ] Use the `feed-to-sqlite` library to ingest the data.
    - [ ] Ensure that feed items are inserted only once to prevent duplicates.

- [ ] **4. Add Error Handling:**
    - [ ] Implement error handling for file I/O operations.
    - [ ] Implement error handling for database operations.
    - [ ] Implement error handling for feed parsing.

- [ ] **5. Create Tests:**
    - [ ] Add unit tests for the `ingest` subcommand.
    - [ ] Test reading from files.
    - [ ] Test reading from `stdin`.
    - [ ] Test the `--db` option.
    - [ ] Test overwriting an existing database.
    - [ ] Test with the existing test data in `tests/data`.
    - [ ] Test duplicate feed item handling.
